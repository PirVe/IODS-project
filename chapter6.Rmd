# Week 6: Analysis of longitudinal data

Making libraries available
```{r}
date()
if (!require("pacman")) install.packages("pacman") 
pacman::p_load(tidyverse, forcats, haven, janitor, psych, lm.beta, broom, writexl,sjstats, knitr, pwr, corrplot, tidyr, dplyr, ggplot2, GGally)
library(corrplot)
library(tidyr)
library(dplyr)
library(ggplot2)
library(GGally)
```

This week we are analysing longitudinal data with not-related datasets about weights of rats (RATS) and symptom assessment on human males (BPRS).

After reading the datasets to R, we'll have to convert the first two variables to factors. For visualization purposes, new columns to help see the passed time will be created: "week" to BPRS and "Time" to RATS.

```{r}
# BPRS data:
BPRS <- read.table("https://raw.githubusercontent.com/KimmoVehkalahti/MABS/master/Examples/data/BPRS.txt", sep  =" ", header = T)
BPRS$treatment <- factor(BPRS$treatment)
BPRS$subject <- factor(BPRS$subject)

# RATS data:
RATS <- read.table("https://raw.githubusercontent.com/KimmoVehkalahti/MABS/master/Examples/data/rats.txt", sep  ="\t", header = T)
RATS$ID <- factor(RATS$ID)
RATS$Group <- factor(RATS$Group)

# Converting both datasets to long form
BPRSL <-  BPRS %>% gather(key = weeks, value = bprs, -treatment, -subject)
RATSL <- RATS %>% gather(key = WD, value = Weight, -ID, -Group)

# Add the week column to BPRSL
BPRSL <-  BPRSL %>% mutate(week = as.integer(substr(weeks,5,5)))

# Add the time column to RATSL
RATSL <- RATSL %>% mutate(Time = as.integer(substr(WD,3,4))) 


# Glimpse the data to check variable names and data contents
glimpse(RATSL)
glimpse(BPRSL)

```